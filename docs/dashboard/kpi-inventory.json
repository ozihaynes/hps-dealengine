[
  {
    "id": "wholesale_fee",
    "label": "Wholesale Fee",
    "component": "OverviewTab/Wholesale StatCard",
    "cardGroup": "Wholesale Fees",
    "unit": "currency",
    "analyzeFields": ["outputs.buyer_ceiling", "outputs.respect_floor", "calculations.buyerCeiling", "calculations.respectFloorPrice"],
    "dealFields": ["deal.market.arv"],
    "derivedFromKnobs": ["minSpreadByArvBand", "buyerCeilingFormulaDefinition", "assignmentFeeTargetPctOfArv"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "profit_spread",
    "description": "Spread between buyer ceiling and respect floor prior to double-close friction.",
    "storyRole": "hero",
    "notes": "Computed via getWholesaleFeeView; should mirror Underwrite wholesale math."
  },
  {
    "id": "wholesale_fee_with_dc",
    "label": "Wholesale Fee w/ DC",
    "component": "OverviewTab/Wholesale StatCard",
    "cardGroup": "Wholesale Fees",
    "unit": "currency",
    "analyzeFields": ["outputs.buyer_ceiling", "outputs.respect_floor"],
    "dealFields": ["deal.costs.double_close"],
    "derivedFromKnobs": ["doubleCloseCarryPctDefault", "doubleCloseFeeDefaults"],
    "primaryTabs": ["Underwrite"],
    "category": "profit_spread",
    "description": "Wholesale spread after estimated double-close load.",
    "storyRole": "supporting",
    "notes": "Uses DoubleClose.autofill/computeDoubleClose with deal.costs.double_close."
  },
  {
    "id": "hero_arv_mao",
    "label": "ARV and MAO",
    "component": "TopDealKpis/Valuation tile",
    "cardGroup": "Top Strip",
    "unit": "currency",
    "analyzeFields": ["outputs.primary_offer", "outputs.mao_wholesale"],
    "dealFields": ["deal.market.arv"],
    "derivedFromKnobs": ["maoCalculationMethodArvAivMultiplierSelection", "aivSafetyCapPercentage"],
    "primaryTabs": ["Underwrite"],
    "category": "valuation",
    "description": "Shows stated ARV and the engine-selected MAO for the primary path.",
    "storyRole": "hero",
    "notes": "Discount to ARV is computed from these values."
  },
  {
    "id": "discount_to_arv_pct",
    "label": "Discount vs ARV %",
    "component": "TopDealKpis/Valuation tile",
    "cardGroup": "Top Strip",
    "unit": "percent",
    "analyzeFields": ["outputs.primary_offer"],
    "dealFields": ["deal.market.arv"],
    "derivedFromKnobs": ["minSpreadByArvBand", "assignmentFeeTargetPctOfArv"],
    "primaryTabs": ["Underwrite"],
    "category": "valuation",
    "description": "Percent discount between ARV and primary offer.",
    "storyRole": "supporting",
    "notes": "Displayed alongside dollar discount."
  },
  {
    "id": "discount_to_arv_dollars",
    "label": "Discount vs ARV $",
    "component": "TopDealKpis/Valuation tile",
    "cardGroup": "Top Strip",
    "unit": "currency",
    "analyzeFields": ["outputs.primary_offer"],
    "dealFields": ["deal.market.arv"],
    "derivedFromKnobs": ["minSpreadByArvBand"],
    "primaryTabs": ["Underwrite"],
    "category": "valuation",
    "description": "Dollar gap between ARV and the primary offer.",
    "storyRole": "supporting",
    "notes": "Simple subtraction ARV - primary_offer."
  },
  {
    "id": "assignment_fee_cash",
    "label": "Assignment / Spread",
    "component": "TopDealKpis/Assignment tile",
    "cardGroup": "Top Strip",
    "unit": "currency",
    "analyzeFields": ["outputs.spread_cash", "outputs.assignment_fee"],
    "dealFields": ["deal.market.arv"],
    "derivedFromKnobs": ["assignmentFeeTargetPctOfArv", "assignmentFeeMaxPctOfArv"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "profit_spread",
    "description": "Assignment fee or spread for the wholesale path.",
    "storyRole": "hero",
    "notes": "Displays as dollars and % of ARV."
  },
  {
    "id": "assignment_fee_pct_arv",
    "label": "Assignment % of ARV",
    "component": "TopDealKpis/Assignment tile",
    "cardGroup": "Top Strip",
    "unit": "percent",
    "analyzeFields": ["outputs.spread_cash"],
    "dealFields": ["deal.market.arv"],
    "derivedFromKnobs": ["assignmentFeeTargetPctOfArv", "assignmentFeeMaxPctOfArv"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "profit_spread",
    "description": "Spread expressed as a percent of ARV compared to policy target/max.",
    "storyRole": "supporting",
    "notes": "Computed inline in TopDealKpis."
  },
  {
    "id": "assignment_policy_targets",
    "label": "Assignment Policy Target/Max",
    "component": "TopDealKpis/Assignment tile",
    "cardGroup": "Top Strip",
    "unit": "percent",
    "analyzeFields": ["trace.ASSIGNMENT_FEE_POLICY.details.assignment_fee_target", "trace.ASSIGNMENT_FEE_POLICY.details.max_publicized_pct_of_arv"],
    "dealFields": ["deal.market.arv"],
    "derivedFromKnobs": ["assignmentFeeTargetPctOfArv", "assignmentFeeMaxPctOfArv"],
    "primaryTabs": ["Sandbox"],
    "category": "profit_spread",
    "description": "Policy target and cap for assignment as % of ARV.",
    "storyRole": "supporting",
    "notes": "Read from trace frame ASSIGNMENT_FEE_POLICY."
  },
  {
    "id": "timeline_days_to_money",
    "label": "Days to Money",
    "component": "TopDealKpis/Timeline tile",
    "cardGroup": "Top Strip",
    "unit": "days",
    "analyzeFields": ["outputs.timeline_summary.dtm_selected_days", "outputs.timeline_summary.days_to_money"],
    "dealFields": ["deal.timeline.close_date", "deal.timeline.auction_date"],
    "derivedFromKnobs": ["dtmDefaultCashDays", "dtmUrgencyBands"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "timeline",
    "description": "Selected days-to-money for the active path including buffers.",
    "storyRole": "hero",
    "notes": "Also surfaced in Timeline & Carry card."
  },
  {
    "id": "timeline_speed_band",
    "label": "Speed Band",
    "component": "TopDealKpis/Timeline tile",
    "cardGroup": "Top Strip",
    "unit": "categorical",
    "analyzeFields": ["outputs.timeline_summary.speed_band"],
    "dealFields": [],
    "derivedFromKnobs": ["speedBandPolicy"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "timeline",
    "description": "Engine-selected market speed band driving urgency.",
    "storyRole": "supporting",
    "notes": "Rendered with the DTM value."
  },
  {
    "id": "risk_overall_badge",
    "label": "Risk Overall",
    "component": "TopDealKpis badges",
    "cardGroup": "Top Strip",
    "unit": "categorical",
    "analyzeFields": ["outputs.risk_summary.overall"],
    "dealFields": [],
    "derivedFromKnobs": ["riskGate*"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "risk",
    "description": "Aggregated risk posture across gates.",
    "storyRole": "supporting",
    "notes": "Badge color driven by pass/watch/fail."
  },
  {
    "id": "confidence_grade_badge",
    "label": "Confidence Grade",
    "component": "TopDealKpis badges",
    "cardGroup": "Top Strip",
    "unit": "categorical",
    "analyzeFields": ["outputs.confidence_grade"],
    "dealFields": [],
    "derivedFromKnobs": ["confidenceRubric", "allowPlaceholdersWhenEvidenceMissing"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "evidence",
    "description": "Confidence grade from engine evidence/inputs.",
    "storyRole": "supporting",
    "notes": "Shared with Data & Evidence card."
  },
  {
    "id": "workflow_state_badge",
    "label": "Workflow State",
    "component": "TopDealKpis badges",
    "cardGroup": "Top Strip",
    "unit": "categorical",
    "analyzeFields": ["outputs.workflow_state"],
    "dealFields": [],
    "derivedFromKnobs": ["workflowStatePolicy"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "workflow",
    "description": "Offer readiness state from policy.",
    "storyRole": "supporting",
    "notes": "Mirrors Data & Evidence workflow pill."
  },
  {
    "id": "guardrails_status",
    "label": "Guardrails Status",
    "component": "DealHealthStrip/Guardrails",
    "cardGroup": "Deal Health",
    "unit": "categorical",
    "analyzeFields": ["outputs.respect_floor", "outputs.buyer_ceiling", "outputs.primary_offer", "calculations.instantCashOffer", "calculations.respectFloorPrice", "calculations.buyerCeiling"],
    "dealFields": ["deal.policy.min_spread"],
    "derivedFromKnobs": ["minSpreadByArvBand"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "guardrails",
    "description": "Whether offer sits within respect floor and buyer ceiling.",
    "storyRole": "supporting",
    "notes": "Uses a UI tightness band of $5k; not a policy threshold."
  },
  {
    "id": "dealhealth_risk_posture",
    "label": "Risk Posture",
    "component": "DealHealthStrip/Risk",
    "cardGroup": "Deal Health",
    "unit": "categorical",
    "analyzeFields": ["calculations.dealSpread", "outputs.respect_floor", "outputs.buyer_ceiling"],
    "dealFields": ["deal.policy.min_spread"],
    "derivedFromKnobs": ["minSpreadByArvBand"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "risk",
    "description": "Pass/Watch/Fail derived from spread vs policy min spread.",
    "storyRole": "supporting",
    "notes": "Maps getDealHealth color to risk label."
  },
  {
    "id": "dealhealth_confidence_grade",
    "label": "Confidence Badge",
    "component": "DealHealthStrip/Confidence",
    "cardGroup": "Deal Health",
    "unit": "categorical",
    "analyzeFields": ["outputs.confidence_grade"],
    "dealFields": [],
    "derivedFromKnobs": ["confidenceRubric", "allowPlaceholdersWhenEvidenceMissing"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "evidence",
    "description": "Confidence badge reused from evidence summary.",
    "storyRole": "supporting",
    "notes": "Defaults to C when no run."
  },
  {
    "id": "dealhealth_workflow_state",
    "label": "Workflow Badge",
    "component": "DealHealthStrip/Workflow",
    "cardGroup": "Deal Health",
    "unit": "categorical",
    "analyzeFields": ["outputs.workflow_state"],
    "dealFields": [],
    "derivedFromKnobs": ["workflowStatePolicy"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "workflow",
    "description": "Needs run/review/ready state shown in health strip.",
    "storyRole": "supporting",
    "notes": "UI-level derivation when missing offer/floor/ceiling."
  },
  {
    "id": "respect_floor_value",
    "label": "Respect Floor",
    "component": "GuardrailsCard/StatCard",
    "cardGroup": "Guardrails & Profit",
    "unit": "currency",
    "analyzeFields": ["outputs.respect_floor", "calculations.respectFloorPrice"],
    "dealFields": ["deal.policy.min_spread"],
    "derivedFromKnobs": ["respectFloorPolicy", "investorFloorDiscounts"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "guardrails",
    "description": "Floor price protecting payoff + essentials.",
    "storyRole": "hero",
    "notes": "Also shown in DealStructureChart markers."
  },
  {
    "id": "current_offer_value",
    "label": "Current Offer",
    "component": "GuardrailsCard/StatCard",
    "cardGroup": "Guardrails & Profit",
    "unit": "currency",
    "analyzeFields": ["calculations.instantCashOffer", "outputs.primary_offer", "outputs.mao_wholesale"],
    "dealFields": [],
    "derivedFromKnobs": ["maoPolicySelection", "cashGateMinimumSpread"],
    "primaryTabs": ["Underwrite"],
    "category": "offer",
    "description": "Instant cash offer / MAO used for guardrail deltas.",
    "storyRole": "hero",
    "notes": "Feeds window/headroom deltas."
  },
  {
    "id": "buyer_ceiling_value",
    "label": "Buyer Ceiling",
    "component": "GuardrailsCard/StatCard",
    "cardGroup": "Guardrails & Profit",
    "unit": "currency",
    "analyzeFields": ["outputs.buyer_ceiling", "calculations.buyerCeiling"],
    "dealFields": ["deal.market.arv"],
    "derivedFromKnobs": ["buyerCeilingFormulaDefinition", "minSpreadByArvBand"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "guardrails",
    "description": "Upper bound a buyer can pay per policy.",
    "storyRole": "hero",
    "notes": "Also used in Wholesale cards and structure chart."
  },
  {
    "id": "window_floor_to_offer",
    "label": "Window to Floor",
    "component": "GuardrailsCard/Delta row",
    "cardGroup": "Guardrails & Profit",
    "unit": "currency",
    "analyzeFields": ["outputs.window_floor_to_offer", "calculations.instantCashOffer", "outputs.respect_floor"],
    "dealFields": [],
    "derivedFromKnobs": ["minSpreadByArvBand"],
    "primaryTabs": ["Underwrite"],
    "category": "guardrails",
    "description": "Dollar room from respect floor to offer (negative if below floor).",
    "storyRole": "supporting",
    "notes": "Shown inline and in DealStructureChart."
  },
  {
    "id": "headroom_offer_to_ceiling",
    "label": "Headroom to Ceiling",
    "component": "GuardrailsCard/Delta row",
    "cardGroup": "Guardrails & Profit",
    "unit": "currency",
    "analyzeFields": ["outputs.headroom_offer_to_ceiling", "calculations.instantCashOffer", "outputs.buyer_ceiling"],
    "dealFields": [],
    "derivedFromKnobs": ["minSpreadByArvBand"],
    "primaryTabs": ["Underwrite"],
    "category": "guardrails",
    "description": "Room above the offer before hitting buyer ceiling.",
    "storyRole": "supporting",
    "notes": "Mirrors DealStructureChart headroom ribbon."
  },
  {
    "id": "cushion_vs_payoff",
    "label": "Cushion vs Payoff",
    "component": "GuardrailsCard/Delta row",
    "cardGroup": "Guardrails & Profit",
    "unit": "currency",
    "analyzeFields": ["outputs.cushion_vs_payoff", "outputs.payoff_projected"],
    "dealFields": ["deal.debt.senior_principal", "deal.debt.juniors"],
    "derivedFromKnobs": ["payoffPlusEssentialsPolicy"],
    "primaryTabs": ["Underwrite", "Repairs"],
    "category": "payoff",
    "description": "Distance between payoff and offer window.",
    "storyRole": "supporting",
    "notes": "Also surfaced in DealStructureChart gap/cushion callout."
  },
  {
    "id": "strategy_primary_offer",
    "label": "Primary Offer",
    "component": "StrategyPostureCard/Primary Offer",
    "cardGroup": "Strategy & Posture",
    "unit": "currency",
    "analyzeFields": ["outputs.primary_offer", "outputs.mao_wholesale"],
    "dealFields": ["deal.market.arv"],
    "derivedFromKnobs": ["maoPolicySelection", "primaryTrackPolicy"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "offer",
    "description": "MAO for the selected primary path.",
    "storyRole": "hero",
    "notes": "Displays alongside workflow/confidence badges."
  },
  {
    "id": "strategy_projected_payoff",
    "label": "Projected Payoff",
    "component": "StrategyPostureCard/Projected Payoff",
    "cardGroup": "Strategy & Posture",
    "unit": "currency",
    "analyzeFields": ["outputs.payoff_projected", "calculations.projectedPayoffClose"],
    "dealFields": ["deal.debt.senior_principal", "deal.debt.juniors"],
    "derivedFromKnobs": ["payoffPlusEssentialsPolicy"],
    "primaryTabs": ["Underwrite"],
    "category": "payoff",
    "description": "Payoff used for shortfall/cushion.",
    "storyRole": "supporting",
    "notes": "Shortfall % derived from this and primary offer."
  },
  {
    "id": "strategy_shortfall_to_payoff",
    "label": "Shortfall vs Payoff",
    "component": "StrategyPostureCard/Projected Payoff",
    "cardGroup": "Strategy & Posture",
    "unit": "currency",
    "analyzeFields": ["outputs.payoff_projected", "outputs.primary_offer"],
    "dealFields": ["deal.debt"],
    "derivedFromKnobs": ["payoffPlusEssentialsPolicy"],
    "primaryTabs": ["Underwrite"],
    "category": "payoff",
    "description": "Gap between offer and payoff (or cushion if negative).",
    "storyRole": "supporting",
    "notes": "Also shown in DealStructureChart payoff callout."
  },
  {
    "id": "strategy_bands_gap",
    "label": "Bands & Gap",
    "component": "StrategyPostureCard/Bands",
    "cardGroup": "Strategy & Posture",
    "unit": "categorical",
    "analyzeFields": ["outputs.buyer_band", "outputs.seller_band", "outputs.band_gap_flag", "outputs.sweet_spot"],
    "dealFields": [],
    "derivedFromKnobs": ["bandTightnessPolicy"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "strategy",
    "description": "Seller vs buyer band context and gap/sweet spot flag.",
    "storyRole": "supporting",
    "notes": "Uses outputs bands bundle from strategy view model."
  },
  {
    "id": "mao_bundle_wholesale",
    "label": "MAO Wholesale",
    "component": "StrategyPostureCard/MAOs by Path",
    "cardGroup": "Strategy & Posture",
    "unit": "currency",
    "analyzeFields": ["outputs.mao_wholesale"],
    "dealFields": [],
    "derivedFromKnobs": ["maoPolicySelection"],
    "primaryTabs": ["Underwrite"],
    "category": "offer",
    "description": "Wholesale MAO from engine outputs.",
    "storyRole": "supporting",
    "notes": "Displayed with flip/wholetail/as-is cap."
  },
  {
    "id": "mao_bundle_flip",
    "label": "MAO Flip",
    "component": "StrategyPostureCard/MAOs by Path",
    "cardGroup": "Strategy & Posture",
    "unit": "currency",
    "analyzeFields": ["outputs.mao_flip"],
    "dealFields": [],
    "derivedFromKnobs": ["maoPolicySelection", "repairModel"],
    "primaryTabs": ["Underwrite", "Repairs"],
    "category": "offer",
    "description": "Flip MAO path value.",
    "storyRole": "supporting",
    "notes": "Depends on repairs and disposition costs."
  },
  {
    "id": "mao_bundle_wholetail",
    "label": "MAO Wholetail",
    "component": "StrategyPostureCard/MAOs by Path",
    "cardGroup": "Strategy & Posture",
    "unit": "currency",
    "analyzeFields": ["outputs.mao_wholetail"],
    "dealFields": [],
    "derivedFromKnobs": ["maoPolicySelection", "wholetailFees"],
    "primaryTabs": ["Underwrite", "Repairs"],
    "category": "offer",
    "description": "Wholetail MAO path.",
    "storyRole": "supporting",
    "notes": "Includes light rehab disposition assumptions."
  },
  {
    "id": "mao_bundle_as_is_cap",
    "label": "As-Is Cap",
    "component": "StrategyPostureCard/MAOs by Path",
    "cardGroup": "Strategy & Posture",
    "unit": "currency",
    "analyzeFields": ["outputs.mao_as_is_cap"],
    "dealFields": ["deal.market.as_is_value"],
    "derivedFromKnobs": ["aivSafetyCapPercentage", "aivCapOverrideCondition*"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "offer",
    "description": "As-is capped MAO considering AIV safety cap policy.",
    "storyRole": "supporting",
    "notes": "Relies on AIV cap override gating."
  },
  {
    "id": "strategy_recommendation",
    "label": "Recommendation",
    "component": "StrategyPostureCard/Recommendation",
    "cardGroup": "Strategy & Posture",
    "unit": "text",
    "analyzeFields": ["outputs.strategy_recommendation"],
    "dealFields": [],
    "derivedFromKnobs": ["strategyRecommendationPolicy"],
    "primaryTabs": ["Underwrite"],
    "category": "strategy",
    "description": "Narrative guidance from engine outputs.",
    "storyRole": "supporting",
    "notes": "Displays plain text recommendation."
  },
  {
    "id": "timeline_carry_months",
    "label": "Carry Months",
    "component": "TimelineCarryCard/Carry Months",
    "cardGroup": "Timeline & Carry",
    "unit": "months",
    "analyzeFields": ["outputs.timeline_summary.carry_months", "calculations.carryMonths"],
    "dealFields": ["deal.timeline.close_date"],
    "derivedFromKnobs": ["carryMonthsPolicy", "holdCostsMonthlyDefaults"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "timeline",
    "description": "Carry duration for the selected path.",
    "storyRole": "hero",
    "notes": "Also surfaced in Underwrite snapshot."
  },
  {
    "id": "timeline_carry_monthly",
    "label": "Monthly Hold",
    "component": "TimelineCarryCard/Monthly Hold",
    "cardGroup": "Timeline & Carry",
    "unit": "currency",
    "analyzeFields": ["outputs.timeline_summary.hold_monthly_dollars"],
    "dealFields": ["deal.costs.monthly"],
    "derivedFromKnobs": ["holdCostsMonthlyDefaults", "carryMonthsPolicy"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "timeline",
    "description": "Estimated monthly hold cost.",
    "storyRole": "supporting",
    "notes": "Computed from carry months and cost stack."
  },
  {
    "id": "timeline_carry_total",
    "label": "Total Carry",
    "component": "TimelineCarryCard/Total Carry",
    "cardGroup": "Timeline & Carry",
    "unit": "currency",
    "analyzeFields": ["outputs.timeline_summary.carry_total_dollars", "calculations.carryCosts"],
    "dealFields": ["deal.costs.monthly"],
    "derivedFromKnobs": ["carryMonthsPolicy"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "timeline",
    "description": "Total carry dollars over the modeled duration.",
    "storyRole": "supporting",
    "notes": "Shown with monthly hold."
  },
  {
    "id": "timeline_urgency_label",
    "label": "Urgency",
    "component": "TimelineCarryCard/Badge",
    "cardGroup": "Timeline & Carry",
    "unit": "categorical",
    "analyzeFields": ["outputs.timeline_summary.urgency", "calculations.urgencyBand"],
    "dealFields": [],
    "derivedFromKnobs": ["dtmUrgencyBands", "auctionBufferPolicy"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "timeline",
    "description": "Urgency band (critical/elevated/normal) derived from DTM and policy.",
    "storyRole": "supporting",
    "notes": "Feeds badge color and playbook text."
  },
  {
    "id": "risk_overall_status",
    "label": "Risk Overall",
    "component": "RiskComplianceCard/Overall badge",
    "cardGroup": "Risk & Compliance",
    "unit": "categorical",
    "analyzeFields": ["outputs.risk_summary.overall"],
    "dealFields": [],
    "derivedFromKnobs": ["riskGate*"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "risk",
    "description": "Aggregated risk gate status for the run.",
    "storyRole": "hero",
    "notes": "Displayed as Pass/Watch/Fail badge."
  },
  {
    "id": "risk_gate_insurability",
    "label": "Gate: Insurability",
    "component": "RiskComplianceCard/Gate row",
    "cardGroup": "Risk & Compliance",
    "unit": "categorical",
    "analyzeFields": ["outputs.risk_summary.per_gate.insurability.status", "outputs.risk_summary.insurability"],
    "dealFields": ["deal.status.insurability"],
    "derivedFromKnobs": ["riskGateInsurabilityEnabled"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "risk",
    "description": "Insurance bindability gate status and reasons.",
    "storyRole": "supporting",
    "notes": "Has tooltip via glossary."
  },
  {
    "id": "risk_gate_payoff",
    "label": "Gate: Payoff",
    "component": "RiskComplianceCard/Gate row",
    "cardGroup": "Risk & Compliance",
    "unit": "categorical",
    "analyzeFields": ["outputs.risk_summary.per_gate.payoff.status", "outputs.risk_summary.payoff"],
    "dealFields": ["deal.debt"],
    "derivedFromKnobs": ["payoffVerificationPolicy"],
    "primaryTabs": ["Underwrite"],
    "category": "risk",
    "description": "Payoff/title clearance gate.",
    "storyRole": "supporting",
    "notes": "Reasons pulled from risk_summary per_gate."
  },
  {
    "id": "risk_gate_title",
    "label": "Gate: Title / Liens",
    "component": "RiskComplianceCard/Gate row",
    "cardGroup": "Risk & Compliance",
    "unit": "categorical",
    "analyzeFields": ["outputs.risk_summary.per_gate.title.status", "outputs.risk_summary.title"],
    "dealFields": ["deal.title"],
    "derivedFromKnobs": ["titleRiskPolicy"],
    "primaryTabs": ["Underwrite"],
    "category": "risk",
    "description": "Title/lien clearance gate.",
    "storyRole": "supporting",
    "notes": "Includes FHA/VA flip etc when flagged."
  },
  {
    "id": "risk_gate_fha_va_flip",
    "label": "Gate: FHA / VA Flip",
    "component": "RiskComplianceCard/Gate row",
    "cardGroup": "Risk & Compliance",
    "unit": "categorical",
    "analyzeFields": ["outputs.risk_summary.per_gate.fha_va_flip.status", "outputs.risk_summary.fha_va_flip"],
    "dealFields": ["deal.timeline"],
    "derivedFromKnobs": ["fhaVaFlipPolicy"],
    "primaryTabs": ["Underwrite"],
    "category": "risk",
    "description": "90-day flip rule compliance.",
    "storyRole": "supporting",
    "notes": "Rendered with glossary tooltip."
  },
  {
    "id": "risk_gate_firpta",
    "label": "Gate: FIRPTA",
    "component": "RiskComplianceCard/Gate row",
    "cardGroup": "Risk & Compliance",
    "unit": "categorical",
    "analyzeFields": ["outputs.risk_summary.per_gate.firpta.status", "outputs.risk_summary.firpta"],
    "dealFields": ["deal.legal"],
    "derivedFromKnobs": ["firptaPolicy"],
    "primaryTabs": ["Underwrite"],
    "category": "risk",
    "description": "FIRPTA withholding risk gate.",
    "storyRole": "supporting",
    "notes": "Uses evidence + legal flags."
  },
  {
    "id": "risk_gate_pace_solar_ucc",
    "label": "Gate: PACE / Solar / UCC",
    "component": "RiskComplianceCard/Gate row",
    "cardGroup": "Risk & Compliance",
    "unit": "categorical",
    "analyzeFields": ["outputs.risk_summary.per_gate.pace_solar_ucc.status", "outputs.risk_summary.pace_solar_ucc"],
    "dealFields": ["deal.debt"],
    "derivedFromKnobs": ["paceUccPolicy"],
    "primaryTabs": ["Underwrite"],
    "category": "risk",
    "description": "PACE/solar/UCC encumbrance gate.",
    "storyRole": "supporting",
    "notes": "Reasons displayed in gate list."
  },
  {
    "id": "risk_gate_condo_sirs",
    "label": "Gate: Condo / SIRS",
    "component": "RiskComplianceCard/Gate row",
    "cardGroup": "Risk & Compliance",
    "unit": "categorical",
    "analyzeFields": ["outputs.risk_summary.per_gate.condo_sirs.status", "outputs.risk_summary.condo_sirs"],
    "dealFields": ["deal.property"],
    "derivedFromKnobs": ["condoSirsPolicy"],
    "primaryTabs": ["Underwrite"],
    "category": "risk",
    "description": "Condo milestone/SIRS compliance.",
    "storyRole": "supporting",
    "notes": "Helps flag reserve studies/special assessments."
  },
  {
    "id": "risk_gate_manufactured",
    "label": "Gate: Manufactured",
    "component": "RiskComplianceCard/Gate row",
    "cardGroup": "Risk & Compliance",
    "unit": "categorical",
    "analyzeFields": ["outputs.risk_summary.per_gate.manufactured.status", "outputs.risk_summary.manufactured"],
    "dealFields": ["deal.property"],
    "derivedFromKnobs": ["manufacturedHousingPolicy"],
    "primaryTabs": ["Underwrite"],
    "category": "risk",
    "description": "Manufactured/mobile home risk gate.",
    "storyRole": "supporting",
    "notes": "UI shows gate reason when present."
  },
  {
    "id": "risk_gate_scra",
    "label": "Gate: SCRA",
    "component": "RiskComplianceCard/Gate row",
    "cardGroup": "Risk & Compliance",
    "unit": "categorical",
    "analyzeFields": ["outputs.risk_summary.per_gate.scra.status", "outputs.risk_summary.scra"],
    "dealFields": ["deal.legal"],
    "derivedFromKnobs": ["scraPolicy"],
    "primaryTabs": ["Underwrite"],
    "category": "risk",
    "description": "Active duty/SCRA verification gate.",
    "storyRole": "supporting",
    "notes": "Shows watch/fail when verification missing."
  },
  {
    "id": "evidence_confidence_grade",
    "label": "Confidence Grade",
    "component": "DataEvidenceCard/Badges",
    "cardGroup": "Data & Evidence",
    "unit": "categorical",
    "analyzeFields": ["outputs.confidence_grade", "outputs.evidence_summary.confidence_grade"],
    "dealFields": [],
    "derivedFromKnobs": ["confidenceRubric", "allowPlaceholdersWhenEvidenceMissing"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "evidence",
    "description": "Letter grade for evidence sufficiency.",
    "storyRole": "hero",
    "notes": "Also appears in hero strip."
  },
  {
    "id": "workflow_state_evidence",
    "label": "Workflow State",
    "component": "DataEvidenceCard/Badges",
    "cardGroup": "Data & Evidence",
    "unit": "categorical",
    "analyzeFields": ["outputs.workflow_state"],
    "dealFields": [],
    "derivedFromKnobs": ["workflowStatePolicy"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "workflow",
    "description": "Needs Info/Review/Ready state informed by evidence and spread.",
    "storyRole": "supporting",
    "notes": "Displayed alongside confidence badge."
  },
  {
    "id": "evidence_missing",
    "label": "Missing Evidence",
    "component": "DataEvidenceCard/Missing list",
    "cardGroup": "Data & Evidence",
    "unit": "list",
    "analyzeFields": ["outputs.evidence_summary.freshness_by_kind"],
    "dealFields": ["evidence.*"],
    "derivedFromKnobs": ["allowPlaceholdersWhenEvidenceMissing", "evidenceFreshnessPolicy"],
    "primaryTabs": ["Underwrite"],
    "category": "evidence",
    "description": "List of evidence kinds marked missing.",
    "storyRole": "supporting",
    "notes": "Shown with blocking badge where applicable."
  },
  {
    "id": "evidence_stale",
    "label": "Stale Evidence",
    "component": "DataEvidenceCard/Stale list",
    "cardGroup": "Data & Evidence",
    "unit": "list",
    "analyzeFields": ["outputs.evidence_summary.freshness_by_kind"],
    "dealFields": ["evidence.*"],
    "derivedFromKnobs": ["evidenceFreshnessPolicy"],
    "primaryTabs": ["Underwrite"],
    "category": "evidence",
    "description": "Evidence items present but stale.",
    "storyRole": "supporting",
    "notes": "Includes age days and blocking flag."
  },
  {
    "id": "evidence_blocking",
    "label": "Blocking Evidence",
    "component": "DataEvidenceCard/Blocking list",
    "cardGroup": "Data & Evidence",
    "unit": "list",
    "analyzeFields": ["outputs.evidence_summary.freshness_by_kind"],
    "dealFields": ["evidence.*"],
    "derivedFromKnobs": ["evidenceFreshnessPolicy", "allowPlaceholdersWhenEvidenceMissing"],
    "primaryTabs": ["Underwrite"],
    "category": "evidence",
    "description": "Evidence kinds flagged as blocking Ready state.",
    "storyRole": "supporting",
    "notes": "Blocking flag drives workflow state."
  },
  {
    "id": "evidence_placeholders",
    "label": "Placeholders Used",
    "component": "DataEvidenceCard/Workflow summary",
    "cardGroup": "Data & Evidence",
    "unit": "boolean",
    "analyzeFields": ["trace.EVIDENCE_FRESHNESS_POLICY.details.placeholders_used", "trace.EVIDENCE_FRESHNESS_POLICY.details.placeholder_kinds"],
    "dealFields": [],
    "derivedFromKnobs": ["allowPlaceholdersWhenEvidenceMissing"],
    "primaryTabs": ["Sandbox"],
    "category": "evidence",
    "description": "Whether placeholder evidence was allowed/used and which kinds.",
    "storyRole": "supporting",
    "notes": "Displayed inline in workflow summary."
  },
  {
    "id": "market_temp_score",
    "label": "Market Temp Score",
    "component": "MarketTempGauge",
    "cardGroup": "Overview Extras",
    "unit": "score",
    "analyzeFields": ["outputs.timeline_summary.speed_band", "outputs.timeline_summary.days_to_money"],
    "dealFields": ["deal.market.dom", "deal.market.months_of_inventory"],
    "derivedFromKnobs": ["speedBandPolicy"],
    "primaryTabs": ["Underwrite"],
    "category": "market",
    "description": "Computed score 0-100 indicating market heat.",
    "storyRole": "supporting",
    "notes": "Uses speed band and DTM to set label."
  },
  {
    "id": "deal_analysis_health",
    "label": "Deal Health",
    "component": "OverviewTab/Deal Analysis badge",
    "cardGroup": "Deal Analysis",
    "unit": "categorical",
    "analyzeFields": ["calculations.dealSpread", "deal.policy.min_spread"],
    "dealFields": ["deal.policy.min_spread"],
    "derivedFromKnobs": ["minSpreadByArvBand"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "guardrails",
    "description": "Pass/Tight/Below policy badge based on spread vs min spread.",
    "storyRole": "supporting",
    "notes": "Displayed next to Deal Analysis heading."
  },
  {
    "id": "deal_analysis_urgency",
    "label": "Urgency Label",
    "component": "OverviewTab/Deal Analysis badge",
    "cardGroup": "Deal Analysis",
    "unit": "categorical",
    "analyzeFields": ["calculations.urgencyBand", "outputs.timeline_summary.urgency"],
    "dealFields": [],
    "derivedFromKnobs": ["dtmUrgencyBands", "auctionBufferPolicy"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "timeline",
    "description": "Urgency band shown beside health.",
    "storyRole": "supporting",
    "notes": "Uses urgencyDays when present."
  },
  {
    "id": "buyer_margin_pct",
    "label": "Buyer Margin %",
    "component": "OverviewTab/Deal Analysis Key Data",
    "cardGroup": "Deal Analysis",
    "unit": "percent",
    "analyzeFields": ["calculations.displayMargin"],
    "dealFields": ["deal.policy.margin"],
    "derivedFromKnobs": ["assignmentFeeTargetPctOfArv", "buyerMarginPctPolicy"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "profit_spread",
    "description": "Displayed buyer margin percent from calculations.",
    "storyRole": "supporting",
    "notes": "Renders in Key Data list."
  },
  {
    "id": "contingency_pct",
    "label": "Contingency %",
    "component": "OverviewTab/Deal Analysis Key Data",
    "cardGroup": "Deal Analysis",
    "unit": "percent",
    "analyzeFields": ["calculations.displayCont"],
    "dealFields": ["deal.costs.rehab.contingency_pct"],
    "derivedFromKnobs": ["contingencyPctDefaults"],
    "primaryTabs": ["Underwrite", "Repairs"],
    "category": "repairs",
    "description": "Contingency percentage applied to repairs.",
    "storyRole": "supporting",
    "notes": "From calc.displayCont."
  },
  {
    "id": "carry_months_calc",
    "label": "Carry (calc)",
    "component": "OverviewTab/Deal Analysis Key Data",
    "cardGroup": "Deal Analysis",
    "unit": "months",
    "analyzeFields": ["calculations.carryMonths"],
    "dealFields": ["deal.timeline"],
    "derivedFromKnobs": ["carryMonthsPolicy"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "timeline",
    "description": "Carry months from calculations snapshot.",
    "storyRole": "supporting",
    "notes": "Displayed in Key Data grid."
  },
  {
    "id": "assignment_observed",
    "label": "Assignment Fee (Observed)",
    "component": "OverviewTab/Deal Analysis Key Data",
    "cardGroup": "Deal Analysis",
    "unit": "currency",
    "analyzeFields": ["calculations.maoFinal", "calculations.instantCashOffer"],
    "dealFields": [],
    "derivedFromKnobs": ["assignmentFeeTargetPctOfArv"],
    "primaryTabs": ["Underwrite"],
    "category": "profit_spread",
    "description": "Difference between MAO and instant cash offer.",
    "storyRole": "supporting",
    "notes": "UI-calculated when both values exist."
  },
  {
    "id": "total_repairs",
    "label": "Repairs + Contingency",
    "component": "OverviewTab/Deal Analysis Cost Snapshot",
    "cardGroup": "Deal Analysis",
    "unit": "currency",
    "analyzeFields": ["calculations.totalRepairs"],
    "dealFields": ["deal.repairs.*", "deal.repair_profile"],
    "derivedFromKnobs": ["repairRateProfile", "contingencyPctDefaults"],
    "primaryTabs": ["Repairs"],
    "category": "repairs",
    "description": "Total repairs including contingency.",
    "storyRole": "supporting",
    "notes": "Shown in cost snapshot list."
  },
  {
    "id": "carry_costs_total",
    "label": "Carry Costs",
    "component": "OverviewTab/Deal Analysis Cost Snapshot",
    "cardGroup": "Deal Analysis",
    "unit": "currency",
    "analyzeFields": ["calculations.carryCosts", "outputs.timeline_summary.carry_total_dollars"],
    "dealFields": ["deal.costs.monthly"],
    "derivedFromKnobs": ["carryMonthsPolicy", "holdCostsMonthlyDefaults"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "timeline",
    "description": "Total carry dollars from calculations.",
    "storyRole": "supporting",
    "notes": "Matches Timeline & Carry card."
  },
  {
    "id": "resale_costs",
    "label": "Resale Costs",
    "component": "OverviewTab/Deal Analysis Cost Snapshot",
    "cardGroup": "Deal Analysis",
    "unit": "currency",
    "analyzeFields": ["calculations.resaleCosts"],
    "dealFields": ["deal.costs.resale"],
    "derivedFromKnobs": ["listingCostModelSellerCostLineItems"],
    "primaryTabs": ["Underwrite"],
    "category": "disposition",
    "description": "Disposition/resale cost stack.",
    "storyRole": "supporting",
    "notes": "Uses policy defaults when not specified."
  },
  {
    "id": "projected_payoff_close",
    "label": "Projected Payoff",
    "component": "OverviewTab/Deal Analysis Cost Snapshot",
    "cardGroup": "Deal Analysis",
    "unit": "currency",
    "analyzeFields": ["calculations.projectedPayoffClose", "outputs.payoff_projected"],
    "dealFields": ["deal.debt"],
    "derivedFromKnobs": ["payoffPlusEssentialsPolicy"],
    "primaryTabs": ["Underwrite"],
    "category": "payoff",
    "description": "Projected payoff including arrears/fees.",
    "storyRole": "supporting",
    "notes": "Displayed in cost snapshot and structure chart."
  },
  {
    "id": "tenant_buffer",
    "label": "Tenant Buffer",
    "component": "OverviewTab/Deal Analysis Cost Snapshot",
    "cardGroup": "Deal Analysis",
    "unit": "currency",
    "analyzeFields": ["calculations.tenantBuffer"],
    "dealFields": ["deal.property.occupancy"],
    "derivedFromKnobs": ["tenantMoveOutCashDefaults"],
    "primaryTabs": ["Underwrite", "Sandbox"],
    "category": "risk",
    "description": "Buffer applied when occupied by tenant.",
    "storyRole": "supporting",
    "notes": "Shown only when occupancy=tenant."
  },
  {
    "id": "deal_structure_window",
    "label": "Negotiation Window",
    "component": "DealStructureChart/Window",
    "cardGroup": "Deal Structure",
    "unit": "currency",
    "analyzeFields": ["calculations.instantCashOffer", "outputs.respect_floor"],
    "dealFields": [],
    "derivedFromKnobs": ["minSpreadByArvBand"],
    "primaryTabs": ["Underwrite"],
    "category": "guardrails",
    "description": "Offer minus respect floor visualized as negotiation band.",
    "storyRole": "supporting",
    "notes": "Rendered as orange ribbon on chart."
  },
  {
    "id": "deal_structure_headroom",
    "label": "Buyer Headroom",
    "component": "DealStructureChart/Headroom",
    "cardGroup": "Deal Structure",
    "unit": "currency",
    "analyzeFields": ["calculations.instantCashOffer", "outputs.buyer_ceiling"],
    "dealFields": [],
    "derivedFromKnobs": ["buyerCeilingFormulaDefinition"],
    "primaryTabs": ["Underwrite"],
    "category": "guardrails",
    "description": "Room from offer to buyer ceiling.",
    "storyRole": "supporting",
    "notes": "Blue ribbon segment in chart."
  },
  {
    "id": "deal_structure_payoff_gap",
    "label": "Gap/Cushion vs Payoff",
    "component": "DealStructureChart/Payoff callout",
    "cardGroup": "Deal Structure",
    "unit": "currency",
    "analyzeFields": ["calculations.projectedPayoffClose", "calculations.instantCashOffer"],
    "dealFields": ["deal.debt"],
    "derivedFromKnobs": ["payoffPlusEssentialsPolicy"],
    "primaryTabs": ["Underwrite"],
    "category": "payoff",
    "description": "Shortfall or cushion relative to payoff.",
    "storyRole": "supporting",
    "notes": "Animated if shortfall present."
  },
  {
    "id": "market_temp_label",
    "label": "Market Temp Label",
    "component": "MarketTempGauge",
    "cardGroup": "Overview Extras",
    "unit": "categorical",
    "analyzeFields": ["outputs.timeline_summary.speed_band", "outputs.timeline_summary.days_to_money"],
    "dealFields": ["deal.market.dom", "deal.market.months_of_inventory"],
    "derivedFromKnobs": ["speedBandPolicy"],
    "primaryTabs": ["Underwrite"],
    "category": "market",
    "description": "Cool/Neutral/Warm/Hot label for market heat.",
    "storyRole": "supporting",
    "notes": "Reason text includes speed band and DTM."
  }
]
